<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>

<div class="page-header">
  <h1>Branches</h1>
  <button pButton label="Add Branch" icon="pi pi-plus" class="btn-custom" (click)="openAddDialog()"></button>
</div>

<div class="custom-card">




  <p-table
    #dt
    [value]="branches()"
    [paginator]="true"
    [rows]="10"
    [globalFilterFields]="['BranchCode', 'BranchName', 'Address', 'Phone', 'ManagerName', 'StatusName']"
    styleClass="p-datatable-sm">


    <ng-template pTemplate="caption">
      <div class="table-caption">
        <div class="caption-search">
          <i class="pi pi-search"></i>
          <input type="text" (input)="dt.filterGlobal($any($event.target).value, 'contains')" placeholder="Search..." />
        </div>
        <div class="caption-actions">
          <span class="caption-count">{{ dt.filteredValue?.length ?? branches().length }} records</span>
          <button pButton icon="pi pi-file-pdf" class="caption-pdf-btn" pTooltip="Export to PDF" tooltipPosition="bottom" (click)="exportToPdf()"></button>
          <button pButton icon="pi pi-file-excel" class="caption-export-btn" pTooltip="Export to Excel" tooltipPosition="bottom" (click)="exportToExcel()"></button>
        </div>
      </div>
    </ng-template>
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="BranchCode">Code <p-sortIcon field="BranchCode"></p-sortIcon></th>
        <th pSortableColumn="BranchName">Name <p-sortIcon field="BranchName"></p-sortIcon></th>
        <th pSortableColumn="Address">Address <p-sortIcon field="Address"></p-sortIcon></th>
        <th pSortableColumn="Phone">Phone <p-sortIcon field="Phone"></p-sortIcon></th>
        <th pSortableColumn="ManagerName">Manager <p-sortIcon field="ManagerName"></p-sortIcon></th>
        <th pSortableColumn="StatusName">Status <p-sortIcon field="StatusName"></p-sortIcon></th>
        <th style="width: 120px">Actions</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-branch>
      <tr>
        <td><span class="branch-code">{{ branch.BranchCode }}</span></td>
        <td>{{ branch.BranchName }}</td>
        <td class="address-cell">{{ branch.Address }}</td>
        <td>{{ branch.Phone }}</td>
        <td>{{ branch.ManagerName }}</td>
        <td>
          <p-tag
            [value]="branch.StatusName"
            [severity]="branch.Status === 1 ? 'success' : 'secondary'">
          </p-tag>
        </td>
        <td>
          <div class="action-buttons">
            <button pButton icon="pi pi-eye" class="p-button-text p-button-sm" (click)="viewBranch(branch)"></button>
            <button pButton icon="pi pi-pencil" class="p-button-text p-button-sm" (click)="editBranch(branch)"></button>
            <button pButton icon="pi pi-trash" class="p-button-text p-button-danger p-button-sm" (click)="deleteBranch(branch)"></button>
          </div>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="7" class="text-center">No branches found</td>
      </tr>
    </ng-template>
  </p-table>
</div>
